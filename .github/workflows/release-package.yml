name: Publish NPM Package on Release

on:
  release:
    types: [published]

jobs:
  publish:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Get releases informations
        id: get_release
        uses: actions/github-script@v3
        with:
          script: |
            const release = await github.repos.getReleaseByTag({
              owner: context.repo.owner,
              repo: context.repo.repo,
              tag: context.ref.replace('refs/tags/', '')
            });
            console.log(release.tag)
            return release.data;

      # - uses: pnpm/action-setup@v2
      #   name: Install pnpm
      #   with:
      #     version: 7
      #     run_install: false

      # - name: Install dependencies
      #   run: pnpm install --recursive

      # - name: Use Node.js
      #   uses: actions/setup-node@v2
      #   with:
      #     node-version: '16'

      # - name: Build package
      #   run: npm run build

      # - uses: actions/setup-node@v3
      #   with:
      #     node-version: '20.x'
      #     registry-url: 'https://registry.npmjs.org/'
      #     token: ${{ secrets.NPM_AUTH_TOKEN }}

      # - name: Publish package to NPM
      #   run: |
      #     npm publish --access public
      #   env:
      #     NODE_AUTH_TOKEN: ${{secrets.NPM_AUTH_TOKEN}}